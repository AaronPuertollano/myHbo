<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Resultados</title>
</head>
<body>
<a href="/movies/search" class="back-link">← Volver</a>
<h1>Resultados de la busqueda</h1>

<div class="search-info">
    <strong>Tipus de cerca:</strong>
    <span th:text="${searchType == 'title' ? 'Títol' :
                        searchType == 'actor' ? 'Actor' :
                        searchType == 'character' ? 'Personatge' :
                        searchType == 'genre' ? 'Gènere' :
                        searchType == 'director' ? 'Director' : 'Desconegut'}"></span>
    <br>
    <strong>Terme:</strong> <span th:text="${searchTerm}"></span>
    <br>
    <strong>Resultados obtenidos:</strong> <span th:text="${movies.size()}"></span>
</div>

<div th:if="${movies.isEmpty()}" class="no-results">
    <p>No de ha encontrado ningula pelicula de sus características.</p>
</div>

<div th:if="${error}" class="error" th:text="${error}"></div>

<table th:if="${!movies.isEmpty()}">
    <thead>
    <tr>
        <th>ID</th>
        <th>Titulo</th>
        <th>Fecha de estreno</th>
        <th>Popularidad</th>
        <th>Puntuacion</th>
        <th>Acciones</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="movie : ${movies}">
        <td th:text="${movie.id}"></td>
        <td>
            <a th:href="@{/movies/info(id=${movie.id})}" th:text="${movie.title}">Title</a>
        </td>
        <td th:text="${movie.releaseDate}"></td>
        <td th:text="${movie.popularity}"></td>
        <td th:text="${movie.voteAverage}"></td>
        <td class="action-links">
            <div th:if="${session.username != null}">
                <a th:href="@{/movies/edit(id=${movie.id})}">Editar</a> |
                <form th:action="@{/movies/delete}" method="post" style="display:inline;">
                    <input type="hidden" name="id" th:value="${movie.id}"/>
                    <button type="submit"
                            onclick="return confirm('Estàs seguro?');">
                        Eliminar
                    </button>
                </form>
            </div>

            <div th:if="${session.username == null}">
                        <span class="login-required">
                            Inicia sesion para realizar acciones
                            <a href="/login" style="color: #856404; text-decoration: underline;">Entra aqui</a>
                        </span>
            </div>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>